*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 29/06/93            GET_FILE.SPR               14:50:09 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 1993 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º             GET_FILE Setup Code - SECTION 1             º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#region 1
parameters m.skeleton, m.prompt, m.newfile, m.allfiles, m.chdir, ;
   m.chdrive, m.numdrive
private all except m.skeleton, m.prompt, m.newfile, m.allfiles,;
   m.chdir, m.chdrive

*	m.skeleton	C		Mask for filenames to be included.
*									Defaults to '*.*'.
*
*	m.prompt		C		Prompt for type of file.
*									Defaults to 'Select File:'
*
*	m.newfile		L		If .t., the < New... > push button is available.
*									Defaults to .f.
*
*	m.allfiles	L		If .f., the '[ ] All Files' check box is not available.
*									Defaults to .t.
*
*	m.chdir			L		If .f., the directory popup is not available and
*										directories are not included in the file list.
*									Defaults to .t.
*
*	m.chdrive		L		If .f., the drive popup is not available.
*									Defaults to .t.
*   m.NumDrives     N	 Para restringir el acceso del usuario a los drives de la computadora.


#region 0
regional m.currarea, m.talkstat, m.compstat

if set("TALK") = "ON"
   set talk off
   m.talkstat = "ON"
else
   m.talkstat = "OFF"
endif
m.compstat = set("COMPATIBLE")
set compatible foxplus

m.currarea = select()


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                    Window definitions                   º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

if not wexist("_qh30vsr09")
   define window _qh30vsr09 ;
      from int((srow()-17)/2),int((scol()-48)/2) ;
      to int((srow()-17)/2)+16,int((scol()-48)/2)+47 ;
      float ;
      noclose ;
      shadow ;
      double ;
      color scheme 5
endif


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º             GET_FILE Setup Code - SECTION 2             º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#region 1
for m.i=parameters()+1 to 7
   do case  && define default values
   case m.i=1
      m.skeleton='*.*'
   case m.i=2
      m.prompt='Seleccione Archivo:'
   case m.i=3
      m.newfile=.f.
   case m.i=4
      m.allfiles=.t.
   case m.i=5
      m.chdir=.t.
   case m.i=6
      m.chdrive=.t.
   case m.i=7
      m.numdrive=26
   endcase
endfor

for m.i=1 to parameters()
   do case  && override invalid parameters with defaults
   case m.i=1
      m.skeleton=iif(!type('m.skeleton')='C','*.*',m.skeleton)
   case m.i=2
      m.prompt=iif(!type('m.prompt')='C','Seleccione Archivo:',m.prompt)
   case m.i=3
      m.newfile=iif(!type('m.newfile')='L',.f.,m.newfile)
   case m.i=4
      m.allfiles=iif(!type('m.allfiles')='L',.t.,m.allfiles)
   case m.i=5
      m.chdir=iif(!type('m.chdir')='L',.t.,m.chdir)
   case m.i=6
      m.chdrive=iif(!type('m.chdrive')='L',.t.,m.chdrive)
   case m.i=7
      m.numdrive=iif(!type('m.NumDrive')='N',26,m.numdrive)
   endcase
endfor

m.savepath=set('default')+curdir()   && path to return to on exit

m.isdiskin=.f.
*m.isdiskin=locfile('ISDISKIN.BIN')  OOOOOJOOOOOOO
if !empty(m.isdiskin)
*   load (m.isdiskin)
endif

dimension a_files[1,1]   && array to hold filenames
dimension a_drives[1,1]  && array to hold valid drive designators
dimension a_dirs[1,1]    && array to hold drive and directories in;
   path to current directory

m.l_files=0              && selection from a_files[]
m.o_drives=''            && selection from a_drives[]
m.o_dirs=0               && selection from a_dirs[]
m.k_allfiles=.f.         && All Files checkbox

do iarray with 'files', m.skeleton, m.chdir
m.l_files=iif(!empty(a_files[1,1]),1,0)
do iarray with 'drives'
m.o_drives=a_drives[ASCAN(a_drives,SYS(5)),1]
do iarray with 'path'
m.o_dirs=alen(a_dirs,1)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                 GET_FILE Screen Layout                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#region 1
if wvisible("_qh30vsr09")
   activate window _qh30vsr09 same
else
   activate window _qh30vsr09 noshow
endif
@ 0,3 say m.prompt ;
   size 1,40
@ 1,2 get m.l_files ;
   picture "@&N" ;
   from a_files ;
   size 13,16 ;
   default 1 ;
   when _qh30vstwl() ;
   valid _qh30vsu0l() ;
   color scheme 6
@ 14,3 get m.k_allfiles ;
   picture "@*C Todos los Archivos" ;
   size 1,22 ;
   default 0 ;
   valid _qh30vsu9k()
@ 3,26 say "Drive"
@ 2,32 get m.o_drives ;
   picture "@^" ;
   from a_drives ;
   size 3,12 ;
   default 1 ;
   valid _qh30vsudn() ;
   color scheme 5, 6
@ 5,32 get m.o_dirs ;
   picture "@^" ;
   from a_dirs ;
   size 3,12 ;
   default 1 ;
   valid _qh30vsuj4() ;
   color scheme 5, 6
@ 9,32 get m.h_exitcode ;
   picture "@*VT \!\<Abrir;\<Nuevo..;\?\<Cancela" ;
   size 1,11,1 ;
   default 1
@ 6,21 say "Directorio"

if not wvisible("_qh30vsr09")
   activate window _qh30vsr09
endif

read cycle ;
   activate _qh30vsuq9() ;
   show _qh30vsuqc()

release window _qh30vsr09
select (m.currarea)


#region 0
if m.talkstat = "ON"
   set talk on
endif
if m.compstat = "ON"
   set compatible on
endif


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                  GET_FILE Cleanup Code                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#region 1
set talk off
m.skeleton=''
do case
case m.h_exitcode=1  && open
   for m.i=1 to alen(a_dirs,1)
      m.skeleton=m.skeleton+a_dirs[m.i,1]+'\'
   endfor
   m.skeleton=m.skeleton+a_files[m.l_files,1]
case m.h_exitcode=2  && new
   m.skeleton='NEW FILE'
case m.h_exitcode=3  && cancel
endcase
set default to (left(m.savepath,2))
set default to (left(m.savepath,rat('\',m.savepath)))
if m.talkstat='ON'
   set talk on
endif

return m.skeleton

procedure iarray
parameters withwhat, opt1, opt2

*	optn's interpretation is based on the value of withwhat:
*		FILES    -> SKELETON (*.*), CHDIR (.t.)

do case
case upper(withwhat)=='DRIVES'
   dimension a_drives[1,1]
   m.default=set('default')
   m.onerror=on('error')
   on error m.error=.t.
   m.error=.f.
   m.j=0
   for m.i=1 to m.numdrive
      m.x=chr(64+m.i)+':'
      set default to (m.x)
      if m.error
         m.error=.f.
      else
         m.j=m.j+1
         dimension a_drives[m.j,1]
         a_drives[m.j,1]=m.x
      endif
   endfor
   on error &onerror
   set default to (m.default)
case upper(m.withwhat)='FILES'
   dimension a_files[1,1]
   a_files=.f.
   m.tskeleton=iif(!empty(m.opt1),strtran(m.opt1,' '),'*.*')
   m.tskeleton=iif(m.tskeleton==';','*.',m.tskeleton)
   m.dirs=iif(m.opt2.or.parameters()<4,.t.,.f.)
   dimension x[1,1]
   do while !empty(m.tskeleton)
      do case
      case m.dirs
         m.mask=''
      case ';'$m.tskeleton
         m.mask=left(m.tskeleton,at(';',m.tskeleton)-1)
         m.tskeleton=substr(m.tskeleton,at(';',m.tskeleton)+1)
         m.tskeleton=strtran(m.tskeleton,m.mask+';')
      case '|'$m.tskeleton
         m.mask=left(m.tskeleton,at('|',m.tskeleton)-1)
         m.tskeleton=substr(m.tskeleton,at('|',m.tskeleton)+1)
         m.tskeleton=strtran(m.tskeleton,m.mask+'|')
      otherwise
         m.mask=m.tskeleton
         m.tskeleton=''
      endcase
      if len(m.mask)=3 .and. !'*'$m.mask;
            .and. !'?'$m.mask .and. !'.'$m.mask
         m.mask='*.'+m.mask
      endif
      if m.dirs
         m.dirs=.f.
         m.hits=adir(x,m.mask,'D')
      else
         m.hits=adir(x,m.mask)
      endif
      if !empty(m.hits)
         if empty(a_files[1,1])
            m.offset=0
            dimension a_files[ALEN(X,1),1]
         else
            m.offset=alen(a_files,1)
            dimension;
               a_files[ALEN(a_files,1)+ALEN(X,1),1]
         endif
         for m.i=1 to alen(x,1)
            a_files[m.offset+m.i,1]=iif('D'$x[m.i,5],chr(1),'')+x[m.i,1]
         endfor
      endif
   enddo
   if !empty(a_files[1,1])
      if asort(a_files)<>1
         ??chr(7)
         wait window 'Unsuccessful sort!'
      endif
      for m.i=1 to alen(a_files,1)
         if asc(a_files[m.i,1])=1
            a_files[m.i]='['+substr(a_files[m.i,1],2)+']'
         else
            exit
         endif
      endfor
   else
      a_files=''
   endif
case upper(withwhat)=='PATH'
   dimension a_dirs[1,1]
   a_dirs[1,1]=set('default')
   x=substr(curdir(),2)
   do while !empty(x)
      dimension a_dirs[ALEN(a_dirs,1)+1,1]
      a_dirs[ALEN(a_dirs,1),1]=left(x,at('\',x)-1)
      x=substr(x,at('\',x)+1)
   enddo
endcase
return


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _QH30VSTWL           m.l_files WHEN                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Screen:         GET_FILE,     Record Number:    3  º
*       º Variable:            m.l_files                          º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         List                               º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
function _qh30vstwl      &&  m.l_files WHEN
#region 1
if m.l_files=0
   show get m.h_exitcode,1 disable
endif
if left(a_files(m.l_files,1),1)='['
   show get m.h_exitcode,1 disable
else
   show get m.h_exitcode,1 enable
endif



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _QH30VSU0L           m.l_files VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Screen:         GET_FILE,     Record Number:    3  º
*       º Variable:            m.l_files                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         List                               º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
function _qh30vsu0l      &&  m.l_files VALID
#region 1
if left(a_files[m.l_files,1],1)='['
   m.fromdir=curdir()
   if a_files[m.l_files,1]=='[.]'
      m.fromdir=substr(m.fromdir,2)
      m.fromdir='['+left(m.fromdir,at('\',m.fromdir)-1)+']'
      set default to (m.o_drives+'\')
   else
      if a_files[m.l_files,1]=='[..]'
         m.fromdir=substr(m.fromdir,rat('\',m.fromdir,2)+1)
         m.fromdir='['+left(m.fromdir,len(m.fromdir)-1)+']'
      else
         m.fromdir='[..]'
      endif
      m.dir=''
      for m.i=1 to m.o_dirs-1
         m.dir=m.dir+iif(!empty(m.dir),'\','')+a_dirs(m.i,1)
      endfor
      m.dir=m.dir+iif(!empty(m.dir),'\','')
      if a_files[m.l_files,1]=='[..]'
         set default to (m.dir)
      else
         set default to;
            (m.dir+a_dirs[ALEN(a_dirs,1),1]+'\';
            +strtran(strtran(a_files[m.l_files,1],'['),']')+'\')
      endif
   endif
   do iarray with 'path'
   m.o_dirs=alen(a_dirs,1)
   do iarray with 'files', iif(m.k_allfiles,'*.*',m.skeleton)
   m.l_files=ascan(a_files,m.fromdir)
   _curobj=objnum(m.l_files)
else
   _curobj=objnum(m.h_exitcode)
   keyboard chr(13) plain
endif
show gets


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _QH30VSU9K           m.k_allfiles VALID                 º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Screen:         GET_FILE,     Record Number:    4  º
*       º Variable:            m.k_allfiles                       º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Check Box                          º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
function _qh30vsu9k      &&  m.k_allfiles VALID
#region 1
do iarray with 'files', iif(m.k_allfiles,'*.*',m.skeleton), m.chdir
show gets


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _QH30VSUDN           m.o_drives VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Screen:         GET_FILE,     Record Number:    6  º
*       º Variable:            m.o_drives                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Popup                              º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
function _qh30vsudn      &&  m.o_drives VALID
#region 1
if !empty(m.isdiskin)
   m.drive=m.o_drives
   call isdiskin with m.drive
   if m.drive='0:'
      ??chr(7)
      wait window nowait 'Drive '+m.o_drives+' no est  listo!'
      return 0
   endif
endif
set default to (m.o_drives+curdir(m.o_drives))
do iarray with 'path'
m.o_dirs=alen(a_dirs,1)
do iarray with 'files', iif(m.k_allfiles,'*.*',m.skeleton), m.chdir
m.l_files=iif(!empty(a_files[1,1]),1,0)
_curobj=objnum(m.l_files)
show gets


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _QH30VSUJ4           m.o_dirs VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Screen:         GET_FILE,     Record Number:    7  º
*       º Variable:            m.o_dirs                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Popup                              º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
function _qh30vsuj4      &&  m.o_dirs VALID
#region 1
m.dir=''
for m.i=1 to m.o_dirs
   m.dir=m.dir+iif(!empty(m.dir),'\','')+a_dirs(m.i,1)
endfor
set default to (m.dir+'\')
do iarray with 'path'
m.o_dirs=alen(a_dirs,1)
do iarray with 'files', iif(m.k_allfiles,'*.*',m.skeleton), m.chdir
m.l_files=iif(!empty(a_files[1,1]),1,0)
_curobj=objnum(m.l_files)
show gets


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _QH30VSUQ9           Read Level Activate                º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Screen:         GET_FILE                           º
*       º Called By:           READ Statement                     º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
function _qh30vsuq9      && Read Level Activate
*
* Activate Code from screen: GET_FILE
*
#region 1
if !m.chdrive
   show get m.o_drives disable
endif
if !m.chdir
   show get m.o_dirs disable
endif
if !m.allfiles
   show get m.k_allfiles disable
endif
if !m.newfile
   show get m.h_exitcode,2 disable
endif
if m.skeleton=='*.*' .or. empty(m.skeleton)
   m.k_allfiles=.t.
   show get m.k_allfiles disable
endif
**\\
if m.l_files=0
   show get m.h_exitcode,1 disable
endif


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _QH30VSUQC           Read Level Show                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Screen:         GET_FILE                           º
*       º Called By:           READ Statement                     º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
function _qh30vsuqc      && Read Level Show
private currwind
store woutput() to currwind
*
* Show Code from screen: GET_FILE
*
#region 1
if empty(a_files[1,1]) or m.l_files=0
   show get m.l_files disable
else
   show get m.l_files enable
endif

if sys(2016) = "_QH30VSR09" or sys(2016) = "*"
   activate window _qh30vsr09 same
   @ 0,3 say m.prompt ;
      size 1,40
endif
if not empty(currwind)
   activate window (currwind) same
endif
*: EOF: GET_FILE.PRG
